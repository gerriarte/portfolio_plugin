<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagn√≥stico de Modal Portfolio</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .diagnostic-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .diagnostic-section h2 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #2196F3;
            padding-bottom: 10px;
        }
        .status-ok {
            color: #4CAF50;
            font-weight: bold;
        }
        .status-error {
            color: #f44336;
            font-weight: bold;
        }
        .status-warning {
            color: #FF9800;
            font-weight: bold;
        }
        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover {
            background: #1976D2;
        }
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            border-left: 4px solid;
        }
        .test-result.success {
            background: #E8F5E9;
            border-color: #4CAF50;
        }
        .test-result.error {
            background: #FFEBEE;
            border-color: #f44336;
        }
        .test-result.warning {
            background: #FFF3E0;
            border-color: #FF9800;
        }
    </style>
</head>
<body>
    <h1>üîç Diagn√≥stico de Modal Portfolio</h1>
    <p>Este script te ayudar√° a identificar por qu√© el modal no muestra la informaci√≥n del proyecto.</p>
    
    <div class="diagnostic-section">
        <h2>üìã Instrucciones</h2>
        <ol>
            <li><strong>Abre esta p√°gina en tu navegador</strong></li>
            <li><strong>Abre las herramientas de desarrollador</strong> (F12)</li>
            <li><strong>Ve a la pesta√±a Console</strong></li>
            <li><strong>Copia y pega el siguiente c√≥digo</strong> en la consola</li>
            <li><strong>Ejecuta cada test</strong> para identificar el problema</li>
        </ol>
    </div>
    
    <div class="diagnostic-section">
        <h2>üß™ Test 1: Verificar jQuery</h2>
        <button onclick="test1()">Ejecutar Test 1</button>
        <div id="test1-result"></div>
        <pre><code>// Test 1: Verificar jQuery
function test1() {
    console.log('=== TEST 1: VERIFICAR JQUERY ===');
    
    if (typeof jQuery !== 'undefined') {
        console.log('‚úÖ jQuery est√° disponible');
        console.log('   Versi√≥n:', jQuery.fn.jquery);
        document.getElementById('test1-result').innerHTML = 
            '<div class="test-result success">‚úÖ jQuery disponible (v' + jQuery.fn.jquery + ')</div>';
        return true;
    } else {
        console.log('‚ùå jQuery NO est√° disponible');
        document.getElementById('test1-result').innerHTML = 
            '<div class="test-result error">‚ùå jQuery NO disponible</div>';
        return false;
    }
}</code></pre>
    </div>
    
    <div class="diagnostic-section">
        <h2>üß™ Test 2: Verificar Objeto portfolio_frontend</h2>
        <button onclick="test2()">Ejecutar Test 2</button>
        <div id="test2-result"></div>
        <pre><code>// Test 2: Verificar objeto portfolio_frontend
function test2() {
    console.log('=== TEST 2: VERIFICAR OBJETO portfolio_frontend ===');
    
    if (typeof portfolio_frontend !== 'undefined') {
        console.log('‚úÖ Objeto portfolio_frontend disponible');
        console.log('   AJAX URL:', portfolio_frontend.ajax_url);
        console.log('   Nonce:', portfolio_frontend.nonce);
        document.getElementById('test2-result').innerHTML = 
            '<div class="test-result success">‚úÖ Objeto portfolio_frontend disponible<br>' +
            'AJAX URL: ' + portfolio_frontend.ajax_url + '<br>' +
            'Nonce: ' + portfolio_frontend.nonce + '</div>';
        return true;
    } else {
        console.log('‚ùå Objeto portfolio_frontend NO disponible');
        document.getElementById('test2-result').innerHTML = 
            '<div class="test-result error">‚ùå Objeto portfolio_frontend NO disponible</div>';
        return false;
    }
}</code></pre>
    </div>
    
    <div class="diagnostic-section">
        <h2>üß™ Test 3: Verificar Botones de Proyecto</h2>
        <button onclick="test3()">Ejecutar Test 3</button>
        <div id="test3-result"></div>
        <pre><code>// Test 3: Verificar botones de proyecto
function test3() {
    console.log('=== TEST 3: VERIFICAR BOTONES DE PROYECTO ===');
    
    const buttons = jQuery('.portfolio-view-btn');
    console.log('Botones encontrados:', buttons.length);
    
    if (buttons.length > 0) {
        let html = '<div class="test-result success">‚úÖ Botones encontrados: ' + buttons.length + '<br><ul>';
        buttons.each(function(index) {
            const projectId = jQuery(this).data('project-id');
            const text = jQuery(this).text().trim();
            console.log('Bot√≥n', index + 1, '- ID:', projectId, '- Texto:', text);
            html += '<li>Bot√≥n ' + (index + 1) + ': ID=' + projectId + ', Texto="' + text + '"</li>';
        });
        html += '</ul></div>';
        document.getElementById('test3-result').innerHTML = html;
        return true;
    } else {
        console.log('‚ùå No se encontraron botones');
        document.getElementById('test3-result').innerHTML = 
            '<div class="test-result error">‚ùå No se encontraron botones de proyecto</div>';
        return false;
    }
}</code></pre>
    </div>
    
    <div class="diagnostic-section">
        <h2>üß™ Test 4: Verificar Modal en DOM</h2>
        <button onclick="test4()">Ejecutar Test 4</button>
        <div id="test4-result"></div>
        <pre><code>// Test 4: Verificar modal en DOM
function test4() {
    console.log('=== TEST 4: VERIFICAR MODAL EN DOM ===');
    
    const modals = [
        'portfolio-robust-modal',
        'portfolio-simple-modal',
        'portfolio-modal'
    ];
    
    let found = false;
    let html = '<div class="test-result warning">Buscando modales...<br><ul>';
    
    modals.forEach(function(modalId) {
        const modal = jQuery('#' + modalId);
        if (modal.length > 0) {
            console.log('‚úÖ Modal encontrado:', modalId);
            console.log('   Visible:', modal.is(':visible'));
            html += '<li>‚úÖ ' + modalId + ' (Visible: ' + (modal.is(':visible') ? 'S√≠' : 'No') + ')</li>';
            found = true;
        } else {
            console.log('‚ùå Modal NO encontrado:', modalId);
            html += '<li>‚ùå ' + modalId + '</li>';
        }
    });
    
    html += '</ul></div>';
    
    if (found) {
        html = html.replace('warning', 'success');
    } else {
        html = html.replace('warning', 'error');
    }
    
    document.getElementById('test4-result').innerHTML = html;
    return found;
}</code></pre>
    </div>
    
    <div class="diagnostic-section">
        <h2>üß™ Test 5: Probar AJAX Manualmente</h2>
        <button onclick="test5()">Ejecutar Test 5</button>
        <div id="test5-result"></div>
        <pre><code>// Test 5: Probar AJAX manualmente
function test5() {
    console.log('=== TEST 5: PROBAR AJAX MANUALMENTE ===');
    
    if (typeof portfolio_frontend === 'undefined') {
        console.log('‚ùå No se puede probar AJAX sin portfolio_frontend');
        document.getElementById('test5-result').innerHTML = 
            '<div class="test-result error">‚ùå Objeto portfolio_frontend no disponible</div>';
        return false;
    }
    
    const buttons = jQuery('.portfolio-view-btn');
    if (buttons.length === 0) {
        console.log('‚ùå No hay botones para obtener project_id');
        document.getElementById('test5-result').innerHTML = 
            '<div class="test-result error">‚ùå No hay botones de proyecto</div>';
        return false;
    }
    
    const projectId = buttons.first().data('project-id');
    console.log('üìã Probando con Project ID:', projectId);
    
    document.getElementById('test5-result').innerHTML = 
        '<div class="test-result warning">‚è≥ Enviando petici√≥n AJAX para Project ID: ' + projectId + '...</div>';
    
    jQuery.ajax({
        url: portfolio_frontend.ajax_url,
        type: 'POST',
        data: {
            action: 'portfolio_get_project',
            project_id: projectId,
            nonce: portfolio_frontend.nonce
        },
        success: function(response) {
            console.log('‚úÖ Respuesta AJAX recibida:', response);
            
            if (response.success) {
                console.log('üìã Datos del proyecto:', response.data);
                document.getElementById('test5-result').innerHTML = 
                    '<div class="test-result success">‚úÖ AJAX exitoso<br>' +
                    '<strong>T√≠tulo:</strong> ' + response.data.title + '<br>' +
                    '<strong>Categor√≠a:</strong> ' + response.data.category_name + '<br>' +
                    '<strong>Descripci√≥n:</strong> ' + response.data.description.substring(0, 100) + '...<br>' +
                    '<strong>Imagen:</strong> ' + (response.data.featured_image ? 'S√≠' : 'No') + '<br>' +
                    '<strong>Vistas:</strong> ' + response.data.views + '<br>' +
                    '<strong>Likes:</strong> ' + response.data.likes + '</div>';
            } else {
                console.log('‚ùå Error en respuesta:', response);
                document.getElementById('test5-result').innerHTML = 
                    '<div class="test-result error">‚ùå Error: ' + (response.data ? response.data.message : 'Desconocido') + '</div>';
            }
        },
        error: function(xhr, status, error) {
            console.log('‚ùå Error AJAX:', error);
            console.log('   Status:', status);
            console.log('   Response:', xhr.responseText);
            document.getElementById('test5-result').innerHTML = 
                '<div class="test-result error">‚ùå Error AJAX: ' + error + '<br>Status: ' + status + '</div>';
        }
    });
}</code></pre>
    </div>
    
    <div class="diagnostic-section">
        <h2>üß™ Test 6: Verificar Eventos en Botones</h2>
        <button onclick="test6()">Ejecutar Test 6</button>
        <div id="test6-result"></div>
        <pre><code>// Test 6: Verificar eventos en botones
function test6() {
    console.log('=== TEST 6: VERIFICAR EVENTOS EN BOTONES ===');
    
    const buttons = jQuery('.portfolio-view-btn');
    if (buttons.length === 0) {
        console.log('‚ùå No hay botones');
        document.getElementById('test6-result').innerHTML = 
            '<div class="test-result error">‚ùå No hay botones de proyecto</div>';
        return false;
    }
    
    console.log('üìã Verificando eventos en', buttons.length, 'botones');
    
    // Verificar eventos delegados en document
    const docEvents = jQuery._data(jQuery(document)[0], 'events');
    console.log('Eventos en document:', docEvents);
    
    let hasClickEvent = false;
    if (docEvents && docEvents.click) {
        docEvents.click.forEach(function(event) {
            if (event.selector && event.selector.includes('portfolio-view-btn')) {
                console.log('‚úÖ Evento delegado encontrado:', event.selector);
                hasClickEvent = true;
            }
        });
    }
    
    if (hasClickEvent) {
        document.getElementById('test6-result').innerHTML = 
            '<div class="test-result success">‚úÖ Eventos delegados correctamente configurados</div>';
    } else {
        document.getElementById('test6-result').innerHTML = 
            '<div class="test-result error">‚ùå No se encontraron eventos delegados para .portfolio-view-btn</div>';
    }
    
    return hasClickEvent;
}</code></pre>
    </div>
    
    <div class="diagnostic-section">
        <h2>üß™ Test 7: Simular Click en Bot√≥n</h2>
        <button onclick="test7()">Ejecutar Test 7</button>
        <div id="test7-result"></div>
        <pre><code>// Test 7: Simular click en bot√≥n
function test7() {
    console.log('=== TEST 7: SIMULAR CLICK EN BOT√ìN ===');
    
    const buttons = jQuery('.portfolio-view-btn');
    if (buttons.length === 0) {
        console.log('‚ùå No hay botones');
        document.getElementById('test7-result').innerHTML = 
            '<div class="test-result error">‚ùå No hay botones de proyecto</div>';
        return false;
    }
    
    const firstButton = buttons.first();
    const projectId = firstButton.data('project-id');
    
    console.log('üñ±Ô∏è Simulando click en bot√≥n con Project ID:', projectId);
    document.getElementById('test7-result').innerHTML = 
        '<div class="test-result warning">‚è≥ Simulando click... Observa la consola y el modal</div>';
    
    // Simular click
    firstButton.trigger('click');
    
    // Verificar si se abri√≥ el modal
    setTimeout(function() {
        const modals = jQuery('[id*="modal"]');
        let modalOpened = false;
        
        modals.each(function() {
            if (jQuery(this).is(':visible')) {
                console.log('‚úÖ Modal abierto:', this.id);
                modalOpened = true;
            }
        });
        
        if (modalOpened) {
            document.getElementById('test7-result').innerHTML = 
                '<div class="test-result success">‚úÖ Modal se abri√≥ correctamente</div>';
        } else {
            document.getElementById('test7-result').innerHTML = 
                '<div class="test-result error">‚ùå El modal no se abri√≥</div>';
        }
    }, 1000);
}</code></pre>
    </div>
    
    <div class="diagnostic-section">
        <h2>üéØ Test Completo</h2>
        <button onclick="runAllTests()">Ejecutar Todos los Tests</button>
        <div id="all-tests-result"></div>
        <pre><code>// Ejecutar todos los tests
function runAllTests() {
    console.log('=== EJECUTANDO TODOS LOS TESTS ===');
    document.getElementById('all-tests-result').innerHTML = 
        '<div class="test-result warning">‚è≥ Ejecutando tests...</div>';
    
    const results = [];
    results.push(test1());
    results.push(test2());
    results.push(test3());
    results.push(test4());
    
    setTimeout(function() {
        test5();
        test6();
        
        setTimeout(function() {
            test7();
            
            const passed = results.filter(Boolean).length;
            const total = results.length;
            
            let summary = '<div class="test-result ' + (passed === total ? 'success' : 'warning') + '">';
            summary += '<strong>Resumen:</strong> ' + passed + ' de ' + total + ' tests pasaron<br>';
            summary += '<strong>Revisa la consola</strong> para m√°s detalles</div>';
            
            document.getElementById('all-tests-result').innerHTML = summary;
        }, 2000);
    }, 1000);
}</code></pre>
    </div>
    
    <script>
        // Funciones de test (se ejecutan cuando haces click en los botones)
        // El c√≥digo de las funciones est√° en los bloques <pre> arriba
        // C√≥pialas a la consola del navegador para ejecutarlas
        
        function showInstructions() {
            alert('Por favor, copia el c√≥digo JavaScript de cada test a la consola de tu navegador (F12) y ejec√∫talo.');
        }
    </script>
</body>
</html>
